{"file":"permission-CZnaffVS.js","mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAGA,MAAA,aAAe,0BAA0B,CAAC,OAAO;AAC/C,QAAM,OAAO,SAAkB,WAAW;AAC1C,QAAM,OAAO,KAAK,OAAO;AAEzB,MAAI,CAAC,MAAM;AACT,WAAO,WAAW,aAAa;AAAA,EACjC;AAGA,QAAM,mBAA+C;AAAA,IACnD,6BAA6B;AAAA,IAC7B,iCAAiC;AAAA,IACjC,+BAA+B;AAAA,IAC/B,yCAAyC;AAAA,IACzC,oBAAoB;AAAA,EAAA;AAGtB,QAAM,qBAAqB,iBAAiB,GAAG,IAAI;AAEnD,MAAI,sBAAsB,CAAC,cAAc,MAAM,kBAAkB,GAAG;AAClE,WAAO,WAAW,YAAY;AAAA,EAChC;AACF,CAAC;","names":[],"sources":["../../../../../../../app/middleware/permission.ts"],"sourcesContent":["import type { Permission } from '~/types'\nimport { hasPermission } from '~/utils/roles'\n\nexport default defineNuxtRouteMiddleware((to) => {\n  const user = useState<unknown>('auth-user')\n  const role = user.value?.role\n\n  if (!role) {\n    return navigateTo('/auth/login')\n  }\n\n  // Define route permission requirements\n  const routePermissions: Record<string, Permission> = {\n    '/dashboard/anggota/tambah': 'create:anggota' as Permission,\n    '/dashboard/simpanan/transaksi': 'create:simpanan' as Permission,\n    '/dashboard/pinjaman/approve': 'approve:pinjaman' as Permission,\n    '/dashboard/pengaturan/user-management': 'manage:users' as Permission,\n    '/dashboard/audit': 'view:audit' as Permission,\n  }\n\n  const requiredPermission = routePermissions[to.path]\n\n  if (requiredPermission && !hasPermission(role, requiredPermission)) {\n    return navigateTo('/dashboard')\n  }\n})\n"],"version":3}