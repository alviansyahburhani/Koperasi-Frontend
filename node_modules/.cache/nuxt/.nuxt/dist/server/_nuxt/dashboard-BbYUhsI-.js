import { d as __nuxt_component_0, _ as _sfc_main$1 } from "../server.mjs";
import { computed, defineComponent, ref, mergeProps, unref, withCtx, createVNode, createTextVNode, toDisplayString, openBlock, createBlock, createCommentVNode, useSSRContext } from "vue";
import { ssrRenderAttrs, ssrInterpolate, ssrRenderList, ssrRenderComponent, ssrRenderSlot } from "vue/server-renderer";
import { h as hasPermission, R as RoleConfig } from "./roles-CZAztYEA.js";
import { u as useAuth } from "./useAuth-FzT0Z3nn.js";
import { R as Role, P as Permission } from "./index-BLubklIF.js";
import "/home/runner/work/Koperasi-Frontend/Koperasi-Frontend/node_modules/ofetch/dist/node.mjs";
import "#internal/nuxt/paths";
import "/home/runner/work/Koperasi-Frontend/Koperasi-Frontend/node_modules/hookable/dist/index.mjs";
import "/home/runner/work/Koperasi-Frontend/Koperasi-Frontend/node_modules/unctx/dist/index.mjs";
import "/home/runner/work/Koperasi-Frontend/Koperasi-Frontend/node_modules/h3/dist/index.mjs";
import "/home/runner/work/Koperasi-Frontend/Koperasi-Frontend/node_modules/ufo/dist/index.mjs";
import "pinia";
import "/home/runner/work/Koperasi-Frontend/Koperasi-Frontend/node_modules/defu/dist/defu.mjs";
import "vue-router";
import "/home/runner/work/Koperasi-Frontend/Koperasi-Frontend/node_modules/klona/dist/index.mjs";
import "tailwindcss/colors";
import "/home/runner/work/Koperasi-Frontend/Koperasi-Frontend/node_modules/@unhead/vue/dist/index.mjs";
import "@iconify/vue";
import "axios";
import "@iconify/utils/lib/css/icon";
import "/home/runner/work/Koperasi-Frontend/Koperasi-Frontend/node_modules/perfect-debounce/dist/index.mjs";
import "reka-ui";
import "@vueuse/core";
import "tailwind-variants";
import "ohash/utils";
const SuperadminMenu = [
  {
    label: "Dashboard",
    icon: "i-lucide-layout-dashboard",
    to: "/superadmin"
  },
  {
    label: "Permohonan Pendaftaran",
    icon: "i-lucide-inbox",
    to: "/superadmin/permohonan",
    badge: 5
  },
  {
    label: "Koperasi Aktif",
    icon: "i-lucide-building-2",
    to: "/superadmin/koperasi"
  },
  {
    label: "Monitoring",
    icon: "i-lucide-activity",
    to: "/superadmin/monitoring/activity-log"
  },
  {
    label: "Master Data",
    icon: "i-lucide-database",
    children: [
      { label: "Wilayah", to: "/superadmin/master-data/wilayah", icon: "i-lucide-map" },
      {
        label: "Email Template",
        to: "/superadmin/master-data/email-template",
        icon: "i-lucide-mail"
      }
    ]
  }
];
const AdminMenu = [
  {
    label: "Dashboard",
    icon: "i-lucide-layout-dashboard",
    to: "/dashboard"
  },
  {
    label: "Anggota",
    icon: "i-lucide-users",
    to: "/dashboard/anggota",
    permission: Permission.VIEW_ANGGOTA
    // ✅ Use enum
  },
  {
    label: "Simpanan",
    icon: "i-lucide-piggy-bank",
    to: "/dashboard/simpanan",
    permission: Permission.VIEW_SIMPANAN
    // ✅ Use enum
  },
  {
    label: "Pinjaman",
    icon: "i-lucide-hand-coins",
    to: "/dashboard/pinjaman",
    permission: Permission.VIEW_PINJAMAN
    // ✅ Use enum
  },
  {
    label: "Laporan",
    icon: "i-lucide-file-text",
    to: "/dashboard/laporan",
    permission: Permission.VIEW_LAPORAN,
    // ✅ Use enum
    children: [
      {
        label: "Keuangan",
        to: "/dashboard/laporan/keuangan",
        icon: "i-lucide-wallet",
        permission: Permission.VIEW_LAPORAN
        // ✅ Use enum
      },
      {
        label: "16 Buku Wajib",
        to: "/dashboard/laporan/16-buku",
        icon: "i-lucide-book-open",
        permission: Permission.VIEW_LAPORAN
        // ✅ Use enum
      }
    ]
  },
  {
    label: "Audit",
    icon: "i-lucide-shield-check",
    to: "/dashboard/audit",
    permission: Permission.VIEW_AUDIT
    // ✅ Use enum
  },
  {
    label: "Pengaturan",
    icon: "i-lucide-settings",
    permission: Permission.MANAGE_SETTINGS,
    // ✅ Use enum
    children: [
      {
        label: "Profil Koperasi",
        to: "/dashboard/pengaturan/profil-koperasi",
        icon: "i-lucide-building",
        permission: Permission.MANAGE_SETTINGS
        // ✅ Use enum
      },
      {
        label: "User Management",
        to: "/dashboard/pengaturan/user-management",
        icon: "i-lucide-user-cog",
        permission: Permission.MANAGE_USERS
        // ✅ Use enum
      }
    ]
  }
];
function getMenuByRole(role) {
  if (role === Role.SUPERADMIN) {
    return SuperadminMenu;
  }
  return AdminMenu;
}
const usePermission = () => {
  const { role } = useAuth();
  const can = (permission) => {
    if (!role.value) return false;
    return hasPermission(role.value, permission);
  };
  const canAny = (permissions) => {
    return permissions.some((p) => can(p));
  };
  const canAll = (permissions) => {
    return permissions.every((p) => can(p));
  };
  return {
    can,
    canAny,
    canAll
  };
};
const useMenu = () => {
  const { role } = useAuth();
  const { can } = usePermission();
  const filterMenuByPermission = (items) => {
    return items.filter((item) => {
      if (!item.permission) return true;
      if (typeof item.permission === "string") {
        return can(item.permission);
      }
      if (Array.isArray(item.permission)) {
        return item.permission.some((p) => can(p));
      }
      return false;
    }).map((item) => {
      if (item.children && item.children.length > 0) {
        const filteredChildren = filterMenuByPermission(item.children);
        if (filteredChildren.length > 0 || item.to) {
          return {
            ...item,
            children: filteredChildren
          };
        }
        return null;
      }
      return item;
    }).filter((item) => item !== null);
  };
  const menuItems = computed(() => {
    if (!role.value) return [];
    const baseMenu = getMenuByRole(role.value);
    return filterMenuByPermission(baseMenu);
  });
  return {
    menuItems
  };
};
const _sfc_main = /* @__PURE__ */ defineComponent({
  __name: "dashboard",
  __ssrInlineRender: true,
  setup(__props) {
    const { user, role } = useAuth();
    const { menuItems } = useMenu();
    const showMobileSidebar = ref(false);
    ref(false);
    const roleConfig = computed(() => role.value ? RoleConfig[role.value] : null);
    return (_ctx, _push, _parent, _attrs) => {
      const _component_NuxtLink = __nuxt_component_0;
      const _component_UIcon = _sfc_main$1;
      _push(`<div${ssrRenderAttrs(mergeProps({ class: "min-h-screen bg-gray-50" }, _attrs))}><aside class="hidden lg:fixed lg:inset-y-0 lg:flex lg:w-64 lg:flex-col bg-white border-r border-gray-200"><div class="flex flex-col flex-grow pt-5 pb-4 overflow-y-auto"><div class="flex items-center flex-shrink-0 px-4 mb-5"><div class="w-10 h-10 bg-gradient-to-br from-red-600 to-red-700 rounded-lg flex items-center justify-center"><span class="text-white font-bold text-lg">KMP</span></div><div class="ml-3"><h1 class="text-lg font-bold text-gray-900">Koperasi</h1><p class="text-xs text-gray-500">${ssrInterpolate(unref(roleConfig)?.label)}</p></div></div><nav class="flex-1 px-2 space-y-1"><!--[-->`);
      ssrRenderList(unref(menuItems), (item) => {
        _push(`<!--[-->`);
        if (item.children && item.children.length > 0) {
          _push(`<div><div class="px-3 py-2 text-xs font-semibold text-gray-500 uppercase tracking-wider">${ssrInterpolate(item.label)}</div><div class="space-y-1"><!--[-->`);
          ssrRenderList(item.children, (child) => {
            _push(ssrRenderComponent(_component_NuxtLink, {
              key: child.to,
              to: child.to || "#",
              class: "group flex items-center px-3 py-2 text-sm font-medium rounded-md text-gray-700 hover:bg-gray-100 hover:text-red-600 transition-colors",
              "active-class": "bg-red-50 text-red-600"
            }, {
              default: withCtx((_, _push2, _parent2, _scopeId) => {
                if (_push2) {
                  _push2(ssrRenderComponent(_component_UIcon, {
                    name: child.icon,
                    class: "mr-3 flex-shrink-0 h-5 w-5"
                  }, null, _parent2, _scopeId));
                  _push2(` ${ssrInterpolate(child.label)}`);
                } else {
                  return [
                    createVNode(_component_UIcon, {
                      name: child.icon,
                      class: "mr-3 flex-shrink-0 h-5 w-5"
                    }, null, 8, ["name"]),
                    createTextVNode(" " + toDisplayString(child.label), 1)
                  ];
                }
              }),
              _: 2
            }, _parent));
          });
          _push(`<!--]--></div></div>`);
        } else {
          _push(ssrRenderComponent(_component_NuxtLink, {
            to: item.to || "#",
            class: "group flex items-center px-3 py-2 text-sm font-medium rounded-md text-gray-700 hover:bg-gray-100 hover:text-red-600 transition-colors",
            "active-class": "bg-red-50 text-red-600"
          }, {
            default: withCtx((_, _push2, _parent2, _scopeId) => {
              if (_push2) {
                _push2(ssrRenderComponent(_component_UIcon, {
                  name: item.icon,
                  class: "mr-3 flex-shrink-0 h-5 w-5"
                }, null, _parent2, _scopeId));
                _push2(` ${ssrInterpolate(item.label)} `);
                if (item.badge) {
                  _push2(`<span class="ml-auto inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800"${_scopeId}>${ssrInterpolate(item.badge)}</span>`);
                } else {
                  _push2(`<!---->`);
                }
              } else {
                return [
                  createVNode(_component_UIcon, {
                    name: item.icon,
                    class: "mr-3 flex-shrink-0 h-5 w-5"
                  }, null, 8, ["name"]),
                  createTextVNode(" " + toDisplayString(item.label) + " ", 1),
                  item.badge ? (openBlock(), createBlock("span", {
                    key: 0,
                    class: "ml-auto inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800"
                  }, toDisplayString(item.badge), 1)) : createCommentVNode("", true)
                ];
              }
            }),
            _: 2
          }, _parent));
        }
        _push(`<!--]-->`);
      });
      _push(`<!--]--></nav><div class="flex-shrink-0 flex border-t border-gray-200 p-4"><div class="flex items-center w-full"><div class="flex-shrink-0"><div class="h-10 w-10 rounded-full bg-gradient-to-br from-red-600 to-red-700 flex items-center justify-center text-white font-bold">${ssrInterpolate(unref(user)?.name?.charAt(0) || "U")}</div></div><div class="ml-3 flex-1"><p class="text-sm font-medium text-gray-900 truncate">${ssrInterpolate(unref(user)?.name)}</p><p class="text-xs text-gray-500 truncate">${ssrInterpolate(unref(user)?.email)}</p></div><button class="ml-2 text-gray-400 hover:text-red-600 transition-colors">`);
      _push(ssrRenderComponent(_component_UIcon, {
        name: "i-lucide-log-out",
        class: "h-5 w-5"
      }, null, _parent));
      _push(`</button></div></div></div></aside>`);
      if (unref(showMobileSidebar)) {
        _push(`<div class="lg:hidden fixed inset-0 z-40 bg-gray-900 bg-opacity-75"></div>`);
      } else {
        _push(`<!---->`);
      }
      if (unref(showMobileSidebar)) {
        _push(`<aside class="lg:hidden fixed inset-y-0 left-0 z-50 w-64 bg-white border-r border-gray-200"><div class="flex flex-col flex-grow pt-5 pb-4 overflow-y-auto"><div class="flex items-center justify-between px-4 mb-5"><div class="flex items-center"><div class="w-10 h-10 bg-gradient-to-br from-red-600 to-red-700 rounded-lg flex items-center justify-center"><span class="text-white font-bold text-lg">KMP</span></div><div class="ml-3"><h1 class="text-lg font-bold text-gray-900">Koperasi</h1><p class="text-xs text-gray-500">${ssrInterpolate(unref(roleConfig)?.label)}</p></div></div><button class="text-gray-500 hover:text-gray-700">`);
        _push(ssrRenderComponent(_component_UIcon, {
          name: "i-lucide-x",
          class: "w-6 h-6"
        }, null, _parent));
        _push(`</button></div><nav class="flex-1 px-2 space-y-1"><!--[-->`);
        ssrRenderList(unref(menuItems), (item) => {
          _push(`<!--[-->`);
          if (item.children && item.children.length > 0) {
            _push(`<div><div class="px-3 py-2 text-xs font-semibold text-gray-500 uppercase tracking-wider">${ssrInterpolate(item.label)}</div><div class="space-y-1"><!--[-->`);
            ssrRenderList(item.children, (child) => {
              _push(ssrRenderComponent(_component_NuxtLink, {
                key: child.to,
                to: child.to || "#",
                class: "group flex items-center px-3 py-2 text-sm font-medium rounded-md text-gray-700 hover:bg-gray-100 hover:text-red-600 transition-colors",
                "active-class": "bg-red-50 text-red-600",
                onClick: ($event) => showMobileSidebar.value = false
              }, {
                default: withCtx((_, _push2, _parent2, _scopeId) => {
                  if (_push2) {
                    _push2(ssrRenderComponent(_component_UIcon, {
                      name: child.icon,
                      class: "mr-3 flex-shrink-0 h-5 w-5"
                    }, null, _parent2, _scopeId));
                    _push2(` ${ssrInterpolate(child.label)}`);
                  } else {
                    return [
                      createVNode(_component_UIcon, {
                        name: child.icon,
                        class: "mr-3 flex-shrink-0 h-5 w-5"
                      }, null, 8, ["name"]),
                      createTextVNode(" " + toDisplayString(child.label), 1)
                    ];
                  }
                }),
                _: 2
              }, _parent));
            });
            _push(`<!--]--></div></div>`);
          } else {
            _push(ssrRenderComponent(_component_NuxtLink, {
              to: item.to || "#",
              class: "group flex items-center px-3 py-2 text-sm font-medium rounded-md text-gray-700 hover:bg-gray-100 hover:text-red-600 transition-colors",
              "active-class": "bg-red-50 text-red-600",
              onClick: ($event) => showMobileSidebar.value = false
            }, {
              default: withCtx((_, _push2, _parent2, _scopeId) => {
                if (_push2) {
                  _push2(ssrRenderComponent(_component_UIcon, {
                    name: item.icon,
                    class: "mr-3 flex-shrink-0 h-5 w-5"
                  }, null, _parent2, _scopeId));
                  _push2(` ${ssrInterpolate(item.label)} `);
                  if (item.badge) {
                    _push2(`<span class="ml-auto inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800"${_scopeId}>${ssrInterpolate(item.badge)}</span>`);
                  } else {
                    _push2(`<!---->`);
                  }
                } else {
                  return [
                    createVNode(_component_UIcon, {
                      name: item.icon,
                      class: "mr-3 flex-shrink-0 h-5 w-5"
                    }, null, 8, ["name"]),
                    createTextVNode(" " + toDisplayString(item.label) + " ", 1),
                    item.badge ? (openBlock(), createBlock("span", {
                      key: 0,
                      class: "ml-auto inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800"
                    }, toDisplayString(item.badge), 1)) : createCommentVNode("", true)
                  ];
                }
              }),
              _: 2
            }, _parent));
          }
          _push(`<!--]-->`);
        });
        _push(`<!--]--></nav></div></aside>`);
      } else {
        _push(`<!---->`);
      }
      _push(`<div class="lg:pl-64 flex flex-col flex-1"><div class="sticky top-0 z-10 flex-shrink-0 flex h-16 bg-white shadow"><button class="px-4 border-r border-gray-200 text-gray-500 focus:outline-none lg:hidden">`);
      _push(ssrRenderComponent(_component_UIcon, {
        name: "i-lucide-menu",
        class: "h-6 w-6"
      }, null, _parent));
      _push(`</button><div class="flex-1 px-4 flex justify-between items-center"><div class="flex-1"></div><div class="ml-4 flex items-center gap-3"><button class="relative p-2 rounded-full text-gray-400 hover:text-gray-500 hover:bg-gray-100 transition-colors">`);
      _push(ssrRenderComponent(_component_UIcon, {
        name: "i-lucide-bell",
        class: "h-6 w-6"
      }, null, _parent));
      _push(`<span class="absolute top-1 right-1 block h-2 w-2 rounded-full bg-red-400 ring-2 ring-white"></span></button><div class="hidden sm:block"><div class="h-8 w-8 rounded-full bg-gradient-to-br from-red-600 to-red-700 flex items-center justify-center text-white text-sm font-bold">${ssrInterpolate(unref(user)?.name?.charAt(0) || "U")}</div></div></div></div></div><main class="flex-1 overflow-y-auto"><div class="py-6"><div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">`);
      ssrRenderSlot(_ctx.$slots, "default", {}, null, _push, _parent);
      _push(`</div></div></main></div></div>`);
    };
  }
});
const _sfc_setup = _sfc_main.setup;
_sfc_main.setup = (props, ctx) => {
  const ssrContext = useSSRContext();
  (ssrContext.modules || (ssrContext.modules = /* @__PURE__ */ new Set())).add("layouts/dashboard.vue");
  return _sfc_setup ? _sfc_setup(props, ctx) : void 0;
};
export {
  _sfc_main as default
};
//# sourceMappingURL=dashboard-BbYUhsI-.js.map
