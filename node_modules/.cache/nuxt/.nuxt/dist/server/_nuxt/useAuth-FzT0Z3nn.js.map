{"version":3,"file":"useAuth-FzT0Z3nn.js","sources":["../../../../../../../app/composables/core/useAuth.ts"],"sourcesContent":["import type { User } from '~/types'\r\nimport { Role } from '~/types'\r\n\r\nexport const useAuth = () => {\r\n  const user = useState<User | null>('auth-user', () => {\r\n    // Check if we're in browser and have stored session\r\n    if (import.meta.client) {\r\n      const stored = localStorage.getItem('user')\r\n      if (stored) {\r\n        return JSON.parse(stored)\r\n      }\r\n    }\r\n    return null\r\n  })\r\n\r\n  const isAuthenticated = computed(() => !!user.value)\r\n  const role = computed(() => user.value?.role ?? null)\r\n\r\n  const login = async (credentials: { email: string; password: string; remember?: boolean }) => {\r\n    // TODO: Implement real API call\r\n    let userData: User | null = null\r\n\r\n    // Mock login logic\r\n    if (credentials.email === 'superadmin@koperasi.com') {\r\n      userData = {\r\n        id: '1', // ✅ String instead of number\r\n        name: 'Super Admin',\r\n        email: credentials.email,\r\n        role: Role.SUPERADMIN,\r\n      }\r\n    } else if (credentials.email === 'ketua@koperasi.com') {\r\n      userData = {\r\n        id: '2', // ✅ String\r\n        name: 'Ketua Koperasi',\r\n        email: credentials.email,\r\n        role: Role.KETUA,\r\n        cooperativeId: '1', // ✅ String\r\n      }\r\n    } else if (credentials.email === 'bendahara@koperasi.com') {\r\n      userData = {\r\n        id: '3',\r\n        name: 'Bendahara',\r\n        email: credentials.email,\r\n        role: Role.BENDAHARA,\r\n        cooperativeId: '1',\r\n      }\r\n    } else if (credentials.email === 'sekretaris@koperasi.com') {\r\n      userData = {\r\n        id: '4', // ✅ String\r\n        name: 'Sekretaris',\r\n        email: credentials.email,\r\n        role: Role.SEKRETARIS,\r\n        cooperativeId: '1', // ✅ String\r\n      }\r\n    } else if (credentials.email === 'pengawas@koperasi.com') {\r\n      userData = {\r\n        id: '5', // ✅ String\r\n        name: 'Pengawas',\r\n        email: credentials.email,\r\n        role: Role.PENGAWAS,\r\n        cooperativeId: '1', // ✅ String\r\n      }\r\n    } else if (credentials.email === 'anggota@koperasi.com') {\r\n      userData = {\r\n        id: '6', // ✅ String\r\n        name: 'Anggota Koperasi',\r\n        email: credentials.email,\r\n        role: Role.ANGGOTA,\r\n        cooperativeId: '1', // ✅ String\r\n      }\r\n    } else {\r\n      throw new Error('Email atau password salah')\r\n    }\r\n\r\n    user.value = userData\r\n\r\n    // ✅ Store in localStorage if remember me\r\n    if (import.meta.client && credentials.remember) {\r\n      localStorage.setItem('user', JSON.stringify(userData))\r\n    }\r\n\r\n    return { success: true, user: userData }\r\n  }\r\n\r\n  const logout = async () => {\r\n    user.value = null\r\n\r\n    if (import.meta.client) {\r\n      localStorage.removeItem('user')\r\n    }\r\n\r\n    await navigateTo('/auth/login')\r\n  }\r\n\r\n  return {\r\n    user: computed(() => user.value),\r\n    isAuthenticated,\r\n    role,\r\n    login,\r\n    logout,\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;AAGO,MAAM,UAAU,MAAM;AAC3B,QAAM,OAAO,SAAsB,aAAa,MAAM;AAQpD,WAAO;AAAA,EACT,CAAC;AAED,QAAM,kBAAkB,SAAS,MAAM,CAAC,CAAC,KAAK,KAAK;AACnD,QAAM,OAAO,SAAS,MAAM,KAAK,OAAO,QAAQ,IAAI;AAEpD,QAAM,QAAQ,OAAO,gBAAyE;AAE5F,QAAI,WAAwB;AAG5B,QAAI,YAAY,UAAU,2BAA2B;AACnD,iBAAW;AAAA,QACT,IAAI;AAAA;AAAA,QACJ,MAAM;AAAA,QACN,OAAO,YAAY;AAAA,QACnB,MAAM,KAAK;AAAA,MAAA;AAAA,IAEf,WAAW,YAAY,UAAU,sBAAsB;AACrD,iBAAW;AAAA,QACT,IAAI;AAAA;AAAA,QACJ,MAAM;AAAA,QACN,OAAO,YAAY;AAAA,QACnB,MAAM,KAAK;AAAA,QACX,eAAe;AAAA;AAAA,MAAA;AAAA,IAEnB,WAAW,YAAY,UAAU,0BAA0B;AACzD,iBAAW;AAAA,QACT,IAAI;AAAA,QACJ,MAAM;AAAA,QACN,OAAO,YAAY;AAAA,QACnB,MAAM,KAAK;AAAA,QACX,eAAe;AAAA,MAAA;AAAA,IAEnB,WAAW,YAAY,UAAU,2BAA2B;AAC1D,iBAAW;AAAA,QACT,IAAI;AAAA;AAAA,QACJ,MAAM;AAAA,QACN,OAAO,YAAY;AAAA,QACnB,MAAM,KAAK;AAAA,QACX,eAAe;AAAA;AAAA,MAAA;AAAA,IAEnB,WAAW,YAAY,UAAU,yBAAyB;AACxD,iBAAW;AAAA,QACT,IAAI;AAAA;AAAA,QACJ,MAAM;AAAA,QACN,OAAO,YAAY;AAAA,QACnB,MAAM,KAAK;AAAA,QACX,eAAe;AAAA;AAAA,MAAA;AAAA,IAEnB,WAAW,YAAY,UAAU,wBAAwB;AACvD,iBAAW;AAAA,QACT,IAAI;AAAA;AAAA,QACJ,MAAM;AAAA,QACN,OAAO,YAAY;AAAA,QACnB,MAAM,KAAK;AAAA,QACX,eAAe;AAAA;AAAA,MAAA;AAAA,IAEnB,OAAO;AACL,YAAM,IAAI,MAAM,2BAA2B;AAAA,IAC7C;AAEA,SAAK,QAAQ;AAOb,WAAO,EAAE,SAAS,MAAM,MAAM,SAAA;AAAA,EAChC;AAEA,QAAM,SAAS,YAAY;AACzB,SAAK,QAAQ;AAMb,UAAM,WAAW,aAAa;AAAA,EAChC;AAEA,SAAO;AAAA,IACL,MAAM,SAAS,MAAM,KAAK,KAAK;AAAA,IAC/B;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,EAAA;AAEJ;"}