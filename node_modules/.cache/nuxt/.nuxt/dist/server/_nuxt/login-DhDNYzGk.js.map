{"version":3,"file":"login-DhDNYzGk.js","sources":["../../../../../../../app/pages/auth/login.vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport { reactive, ref } from 'vue'\n\ndefinePageMeta({\n  layout: 'default',\n  middleware: 'guest',\n})\n\nuseHead({\n  title: 'Login - Sistem Koperasi',\n  meta: [{ name: 'description', content: 'Login ke sistem koperasi' }],\n})\n\ninterface LoginForm {\n  email: string\n  password: string\n  rememberMe: boolean\n}\n\nconst authStore = useAuthStore()\nconst router = useRouter()\nconst config = useRuntimeConfig()\n\nconst loading = ref(false)\nconst showPassword = ref(false)\nconst errorMessage = ref('')\n\nconst form = reactive<LoginForm>({\n  email: '',\n  password: '',\n  rememberMe: false,\n})\n\nconst handleLogin = async () => {\n  loading.value = true\n  errorMessage.value = ''\n\n  try {\n    if (config.public.debugMode) {\n      console.log('[Login] Attempting login with:', { email: form.email })\n    }\n\n    // Call auth store login\n    const result = await authStore.login({\n      email: form.email,\n      password: form.password,\n    })\n\n    if (result.success) {\n      if (config.public.debugMode) {\n        console.log('[Login] Success! User:', {\n          role: authStore.userRole,\n          isSuperadmin: authStore.isSuperadmin,\n          isAdmin: authStore.isAdmin,\n          isAnggota: authStore.isAnggota,\n        })\n      }\n\n      // ‚úÖ Redirect based on role\n      if (authStore.isSuperadmin) {\n        await router.push('/superadmin')\n      } else if (authStore.isAdmin) {\n        await router.push('/admin')\n      } else if (authStore.isAnggota) {\n        await router.push('/anggota')\n      } else {\n        // Fallback\n        await router.push('/')\n      }\n    } else {\n      // Show error message\n      errorMessage.value = result.message\n    }\n  } catch (error: unknown) {\n    console.error('[Login] Unexpected error:', error)\n    errorMessage.value = 'Terjadi kesalahan yang tidak terduga. Silakan coba lagi.'\n  } finally {\n    loading.value = false\n  }\n}\n</script>\n\n<template>\n  <!-- UI TETAP SAMA - TIDAK BERUBAH -->\n  <div class=\"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4\">\n    <div class=\"max-w-md w-full bg-white rounded-lg shadow-md p-8\">\n      <div class=\"text-center mb-6\">\n        <h1 class=\"text-2xl font-bold text-red-800 mb-2\">Masuk ke Sistem Koperasi</h1>\n        <p class=\"text-sm text-gray-600\">Silakan masuk menggunakan akun Anda</p>\n      </div>\n\n      <div v-if=\"errorMessage\" class=\"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg\">\n        <div class=\"flex items-start gap-2\">\n          <UIcon\n            name=\"i-heroicons-exclamation-circle\"\n            class=\"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5\"\n          />\n          <div class=\"flex-1\">\n            <p class=\"text-sm text-red-800 font-medium\">{{ errorMessage }}</p>\n          </div>\n          <button\n            class=\"text-red-400 hover:text-red-600 transition-colors\"\n            @click=\"errorMessage = ''\"\n          >\n            <UIcon name=\"i-heroicons-x-mark\" class=\"w-4 h-4\" />\n          </button>\n        </div>\n      </div>\n\n      <form class=\"space-y-4\" @submit.prevent=\"handleLogin\">\n        <div>\n          <label class=\"block text-xs text-gray-700 mb-1\">\n            Email <span class=\"text-red-500\">*</span>\n          </label>\n          <input\n            v-model=\"form.email\"\n            type=\"email\"\n            required\n            :disabled=\"loading\"\n            placeholder=\"nama@email.com\"\n            class=\"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-1 focus:ring-red-500 focus:border-red-500 disabled:bg-gray-100 disabled:cursor-not-allowed transition-colors\"\n          >\n        </div>\n\n        <div>\n          <label class=\"block text-xs text-gray-700 mb-1\">\n            Kata Sandi <span class=\"text-red-500\">*</span>\n          </label>\n          <div class=\"relative\">\n            <input\n              v-model=\"form.password\"\n              :type=\"showPassword ? 'text' : 'password'\"\n              required\n              :disabled=\"loading\"\n              placeholder=\"Masukkan kata sandi\"\n              class=\"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-1 focus:ring-red-500 focus:border-red-500 disabled:bg-gray-100 disabled:cursor-not-allowed transition-colors\"\n            >\n            <button\n              type=\"button\"\n              :disabled=\"loading\"\n              class=\"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700 disabled:opacity-50 transition-colors\"\n              @click=\"showPassword = !showPassword\"\n            >\n              <UIcon\n                :name=\"showPassword ? 'i-heroicons-eye-slash' : 'i-heroicons-eye'\"\n                class=\"w-4 h-4\"\n              />\n            </button>\n          </div>\n        </div>\n\n        <div class=\"flex items-center\">\n          <input\n            id=\"remember\"\n            v-model=\"form.rememberMe\"\n            type=\"checkbox\"\n            :disabled=\"loading\"\n            class=\"w-4 h-4 text-red-600 border-gray-300 rounded focus:ring-red-500 disabled:opacity-50\"\n          >\n          <label for=\"remember\" class=\"ml-2 text-xs text-gray-700\"> Ingat saya </label>\n        </div>\n\n        <button\n          type=\"submit\"\n          :disabled=\"loading\"\n          class=\"w-full px-6 py-2.5 bg-red-700 text-white text-sm font-semibold rounded-md hover:bg-red-800 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\n        >\n          <span v-if=\"loading\" class=\"flex items-center justify-center gap-2\">\n            <div\n              class=\"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin\"\n            />\n            Memproses...\n          </span>\n          <span v-else>Masuk</span>\n        </button>\n\n        <div class=\"text-center space-y-2 mt-4\">\n          <p class=\"text-xs text-gray-600\">\n            Belum punya akun?\n            <NuxtLink to=\"/pendaftaran/anggota\" class=\"text-red-700 hover:underline font-medium\">\n              Daftar Menjadi Anggota\n            </NuxtLink>\n          </p>\n          <p class=\"text-xs text-gray-600\">\n            <NuxtLink to=\"/auth/lupa-password\" class=\"text-red-700 hover:underline\">\n              Lupa kata sandi?\n            </NuxtLink>\n          </p>\n        </div>\n      </form>\n\n      <div\n        v-if=\"config.public.debugMode\"\n        class=\"mt-6 p-3 bg-gray-800 text-green-400 rounded text-xs font-mono\"\n      >\n        <p class=\"font-bold mb-2\">üêõ Debug Mode</p>\n        <p>API: {{ config.public.apiBase }}</p>\n        <p>Auth: {{ authStore.isAuthenticated ? 'Yes' : 'No' }}</p>\n        <p>Role: {{ authStore.userRole || 'N/A' }}</p>\n        <p>Tenant: {{ authStore.user?.tenantId || 'N/A' }}</p>\n      </div>\n    </div>\n  </div>\n</template>\n"],"names":["_ssrRenderAttrs","_mergeProps","_ssrRenderAttr","_ssrIncludeBooleanAttr","_ssrLooseContain","_push","_parent","_unref","_ssrInterpolate"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;AAQA,YAAQ;AAAA,MACN,OAAO;AAAA,MACP,MAAM,CAAC,EAAE,MAAM,eAAe,SAAS,4BAA4B;AAAA,IAAA,CACpE;AAQD,UAAM,YAAY,aAAA;AACH,cAAA;AACf,UAAM,SAAS,iBAAA;AAEf,UAAM,UAAU,IAAI,KAAK;AACzB,UAAM,eAAe,IAAI,KAAK;AAC9B,UAAM,eAAe,IAAI,EAAE;AAE3B,UAAM,OAAO,SAAoB;AAAA,MAC/B,OAAO;AAAA,MACP,UAAU;AAAA,MACV,YAAY;AAAA,IAAA,CACb;;;;AAqDM,YAAA,OAAAA,eAAAC,WAAA,EAAA,OAAM,yEAAqE,MAAA,CAAA,CAAA,4PAAA;UAOjE,aAAA,OAAY;;;UAGjB,MAAK;AAAA,UACL,OAAM;AAAA,QAAA;gGAGyC,aAAA,KAAY,CAAA,8EAAA;;UAMpD,MAAK;AAAA,UAAqB,OAAM;AAAA,QAAA;;;;;oJAW9BC,cAAA,SAAA,KAAK,KAAK,gDAGR,QAAA,KAAO,IAAA,cAAA,qZAaT,aAAA,QAAY,SAAA,YADV,KAAK,UAAQ,IAAA,IACrBA,cAAA,QAAM,aAAA,QAAY,SAAA,UAAA,mCAER,QAAA,KAAO,IAAA,cAAA,iSAMP,QAAA,KAAO,IAAA,cAAA;;QAKf,MAAM,aAAA,QAAY,0BAAA;AAAA,QACnB,OAAM;AAAA,MAAA;uFASDC,sBAAA,MAAA,QAAA,KAAK,UAAU,IAAfC,gBAAA,KAAK,YAAU,IAAA,IAAf,KAAK,UAAU,IAAA,aAAA,2CAEb,QAAA,KAAO,IAAA,cAAA,gOAQT,QAAA,KAAO,IAAA,cAAA;UAGN,QAAA,OAAO;;;;;;;QAYP,IAAG;AAAA,QAAuB,OAAM;AAAA,MAAA;yBAA1C,CAEW,GAAAC,QAAAC,UAAA,aAAA;;;;;8BAF0E,0BAErF;AAAA,YAAA;AAAA;;;;;;QAGU,IAAG;AAAA,QAAsB,OAAM;AAAA,MAAA;yBAAzC,CAEW,GAAAD,QAAAC,UAAA,aAAA;;;;;8BAF6D,oBAExE;AAAA,YAAA;AAAA;;;;;UAMEC,MAAA,MAAA,EAAO,OAAO,WAAS;8JAIlBA,MAAA,MAAA,EAAO,OAAO,OAAO,iBACpBC,eAAAD,MAAA,SAAA,EAAU,kBAAe,QAAA,IAAA,iBACzBC,eAAAD,MAAA,SAAA,EAAU,YAAQ,KAAA,kCAChBA,MAAA,SAAA,EAAU,MAAM,YAAQ,KAAA;;;;;;;;;;;;;;"}